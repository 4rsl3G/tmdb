<div id="pjax-page"
     data-title="<%= pageMeta.title %>"
     data-desc="<%= pageMeta.desc %>"
     data-canonical="<%= pageMeta.canonical %>">

  <div class="home-head" data-aos="fade-down">
    <div class="home-title">
      <h1 class="home-h1"><%= homeTitle %></h1>
      <p class="home-sub"><%= homeDesc %></p>
    </div>

    <div class="home-actions">
      <a class="btnx btnx-primary" href="#rail" data-pjax>Explore</a>
      <a class="btnx btnx-ghost" href="#list" data-pjax>Latest</a>
    </div>
  </div>

  <section class="rail" id="rail" data-aos="fade-up">
    <div class="section-head">
      <h2 class="h2">Poster Rail</h2>
      <span class="pill">Swipe / Drag</span>
    </div>

    <div class="poster-rail" id="posterRail" aria-label="Poster rail">
      <% (posts || []).slice(0,20).forEach((p, idx) => { %>
        <a class="poster-card"
           href="/p/<%= p.slug %>" data-pjax
           data-aos="fade-up"
           data-aos-delay="<%= Math.min(240, idx*20) %>">

          <% if (p.poster_url) { %>
            <img loading="lazy" referrerpolicy="no-referrer" src="<%= p.poster_url %>" alt="<%= p.title %> poster"/>
          <% } else { %>
            <div class="poster-fallback">No poster</div>
          <% } %>

          <div class="poster-cap">
            <div class="t"><%= p.title %></div>
            <div class="m">
              <%= p.release_year || "" %>
              <% if (p.vote_average) { %> • ⭐ <%= (p.vote_average||"").toString().slice(0,3) %><% } %>
            </div>
          </div>
        </a>
      <% }) %>
    </div>

    <div class="muted small rail-hint">Drag horizontally • Click a poster to open details</div>
  </section>

  <div class="section-head mt-3" id="list" data-aos="fade-right">
    <h2 class="h2">Latest Movies</h2>
    <span class="pill">Tap to open</span>
  </div>

  <section class="grid" data-aos="fade-up">
    <% (posts || []).forEach((p, i) => { %>
      <a class="cardx"
         href="/p/<%= p.slug %>" data-pjax data-tilt
         data-aos="fade-up"
         data-aos-delay="<%= Math.min(240, i*14) %>">

        <div class="cardx-media">
          <% if (p.poster_url) { %>
            <img loading="lazy" referrerpolicy="no-referrer" src="<%= p.poster_url %>" alt="<%= p.title %> poster"/>
          <% } else { %>
            <div class="card-fallback">Poster unavailable</div>
          <% } %>
        </div>

        <div class="cardx-body">
          <h3 class="cardx-title"><%= p.title %></h3>
          <p class="cardx-excerpt"><%= (p.excerpt||"").slice(0, 120) %></p>

          <div class="cardx-meta">
            <span class="tag"><%= p.release_year || "Movie" %></span>
            <span><% if (p.vote_average) { %>⭐ <%= (p.vote_average||"").toString().slice(0,3) %><% } else { %><span class="muted">New</span><% } %></span>
          </div>
        </div>
      </a>
    <% }) %>
  </section>
</div>
